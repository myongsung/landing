<!doctype html>
<html lang="ko" class="no-js">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />

  <title>REDCLX 레드클렉스</title>
  <meta name="description" content="REDCLX는 민원·학폭·갈등 대응을 ‘단계+규정+증거’로 표준화해 교사의 법적·행정적 리스크를 줄이는 Classroom OS입니다." />
  <meta name="robots" content="index,follow,max-image-preview:large,max-snippet:-1,max-video-preview:-1" />
  <meta name="theme-color" content="#0b0f14" />
  <link rel="canonical" href="https://www.redclexperice.com/" />
  <meta name="keywords" content="REDCLX, redclx, 레드클렉스, 레드클랙스, 교실 운영, 민원 대응, 학폭 대응, 증거 기록, Classroom OS" />

  <meta property="og:site_name" content="REDCLX (레드클렉스·레드클랙스)" />
  <meta property="og:type" content="website" />
  <meta property="og:locale" content="ko_KR" />
  <meta property="og:title" content="REDCLX | 교실 문제상황 대응 Classroom OS" />
  <meta property="og:description" content="민원·학폭·갈등 대응을 ‘검증 가능한 액션’과 ‘증거 패키지’로 표준화합니다." />
  <meta property="og:url" content="https://www.redclexperice.com/" />
  <meta property="og:image" content="https://www.redclexperice.com/assets/og.png" />

  <script>
    document.documentElement.classList.remove("no-js");
    document.documentElement.classList.add("js");
  </script>

  <link rel="preload" href="./styles.css" as="style" />
  <link rel="stylesheet" href="./styles.css" />
</head>

<body>
  <a class="skip-link" href="#main">본문 바로가기</a>

  <!-- GLOBAL MACRO FX (PC only / mobile lite disables via CSS) -->
  <div class="fx" aria-hidden="true"></div>

  <!-- Top Bar -->
  <header class="topbar" role="banner">
    <div class="topbar-inner">
      <a class="topbar-brand" href="#a" aria-label="REDCLX 홈">
        <span class="brand-mark" aria-hidden="true">
          <svg width="22" height="22" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M12 2l7 4v6c0 5-3 9-7 10-4-1-7-5-7-10V6l7-4z" stroke="currentColor" stroke-width="1.6"/>
            <path d="M7 12h10" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/>
          </svg>
        </span>
        <span class="brand-name">REDCLX</span>
      </a>

      <nav class="topbar-nav" aria-label="주요 메뉴">
        <a href="#team">TEAM</a>
        <a href="#b">WHY</a>
        <a href="#product">PRODUCT</a>
        <a href="#c">ENGINE</a>
        <a href="#d">GET STARTED</a>
      </nav>

      <div class="topbar-cta">
        <a class="btn-outline" href="#d">Get Started</a>

        <button class="icon-btn" type="button" aria-label="검색">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M10.5 18a7.5 7.5 0 1 1 0-15 7.5 7.5 0 0 1 0 15Z" stroke="currentColor" stroke-width="1.6"/>
            <path d="M16.6 16.6 21 21" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/>
          </svg>
        </button>

        <button class="icon-btn" type="button" aria-label="메뉴">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M4 7h16" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/>
            <path d="M4 12h16" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/>
            <path d="M4 17h16" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/>
          </svg>
        </button>
      </div>
    </div>
  </header>

  <!-- Left Chapters (PC/모바일 모두 표기) -->
  <nav class="chapters" aria-label="챕터">
    <a class="chapter" href="#a" data-target="a" aria-label="챕터 1.0"><span class="k">1.0</span></a>
    <a class="chapter" href="#b" data-target="b" aria-label="챕터 2.0"><span class="k">2.0</span></a>
    <a class="chapter" href="#c" data-target="c" aria-label="챕터 3.0"><span class="k">3.0</span></a>
    <a class="chapter" href="#d" data-target="d" aria-label="챕터 4.0"><span class="k">4.0</span></a>
  </nav>

  <main id="main">
    <!-- 1.0 / HERO -->
    <section id="a" class="scene scene-a" data-scene="a" data-reveal="scene" aria-label="REDCLX 메인">
      <!-- ✅ Tactical dashboard를 scene-a 전체 배경으로 -->
      <div class="hero-bg" aria-hidden="true"></div>

      <div class="container">
        <div class="hero">
          <!-- ✅ 모바일에서만 우측 세로 워드마크 (CSS에서 mobile-only 처리) -->
          <div class="hero-gotham" aria-hidden="true">REDCLX</div>

          <div class="hero-left">
            <div class="hudline" data-reveal="fade-up">
              <span class="hud-tag">EDUCATION RISK INTELLIGENCE</span>
              <span class="hud-sep">/</span>
              <span class="hud-quote">최고를 위한 교육리스크 전략무기</span>
            </div>

            <h1 class="hero-title" data-reveal="clip-up">
              REDCLX<br/>
              <span class="hero-strong"></span>
            </h1>

            <div class="hero-metrics" data-stagger="70">
              <div class="metric" data-reveal="fade-up">
                <div class="mk">OPERATING SYSTEM FOR</div>
                <div class="mv">Classroom Decision-Making</div>
              </div>
              <div class="metric" data-reveal="fade-up">
                <div class="mk">MODEL</div>
                <div class="mv">Evidence-first · Policy-aware</div>
              </div>
              <div class="metric" data-reveal="fade-up">
                <div class="mk">OUTPUT</div>
                <div class="mv">Verified Actions · Evidence Pack</div>
              </div>
            </div>
          </div>

          <!-- ❌ 기존 hero-right(대시보드 프레임/캡션) 제거 -->
        </div>
      </div>
    </section>

    <!-- TEAM -->
    <section id="team" class="scene scene-team" data-reveal="scene" aria-label="TEAM">
      <div class="container">
        <div class="team-indexbar" aria-hidden="true" data-reveal="fade">
          <span class="tidx">[0.1]</span>
          <span class="tline"></span>
          <span class="tghost">0.2 — 0.3</span>
        </div>

        <div class="team-hero">
          <div class="team-left">
            <div class="team-path" data-reveal="fade-up">REDCLX / TEAM</div>

            <h2 class="team-display" data-reveal="clip-up">
              PRO &amp; SOLVE
            </h2>

            <p class="team-sublead" data-reveal="fade-up" data-delay="90">
              REDCLX는
              최고수준의 두뇌가 모인 <strong>전술·전략 컨설팅형 개발팀</strong>입니다.
            </p>
          </div>

          <div class="team-right">
            <p class="team-copy" data-reveal="fade-up">
              REDCLX 팀은 교육·기술·경영의 교차점에서,
              케이스를 <strong>방어 가능한 실행 체인(Defensive Execution Chain)</strong>으로
              변환하는 데 집중합니다.
            </p>

            <div class="team-spec" aria-label="Team capabilities" data-stagger="70">
              <div class="spec-row" data-reveal="fade-up">
                <div class="spec-k">RISK POSTURE DESIGN</div>
                <div class="spec-v">
                  상황을 “사건”이 아니라 <strong>리스크 포지션</strong>으로 정의합니다.
                  무엇을 언제 누구에게 어떤 형태로 남겨야 방어되는지,
                  <strong>기준(standard)과 절차(sequence)</strong>를 먼저 고정합니다.
                </div>
              </div>

              <div class="spec-row" data-reveal="fade-up">
                <div class="spec-k">COUNTERMEASURE PLAYBOOK</div>
                <div class="spec-v">
                  단계·기한·통지·산출물을 “체크리스트”가 아닌
                  <strong>시스템 제약(guardrail)</strong>로 강제합니다.
                </div>
              </div>

              <div class="spec-row" data-reveal="fade-up">
                <div class="spec-k">AUDIT-READY DEFENSE</div>
                <div class="spec-v">
                  REDCLX는 기본 산출물을 <strong>Evidence Pack</strong>과
                  <strong>Defensive Log</strong>로 정의하고, 누락 가능성을 구조적으로 차단합니다.
                </div>
              </div>

              <div class="spec-row" data-reveal="fade-up">
                <div class="spec-k">DECISION INTELLIGENCE</div>
                <div class="spec-v">
                  <strong>검증 가능한 액션</strong>만 생성하고,
                  불확실하면 <strong>Hold / Escalate / Ask-for-more</strong>로 안전 전환합니다.
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- 2.0 / WHY -->
    <section id="b" class="scene scene-b" data-scene="b" data-reveal="scene" aria-label="WHY">
      <div class="container">
        <div class="why-head">
          <h2 class="scene-title" data-reveal="clip-up">WHY</h2>
          <p class="scene-lead" data-reveal="fade-up" data-delay="90">
            문제는 ‘의지’가 아니라 ‘시스템’입니다. 사건은 복잡하고 기록은 흩어지며,
            <strong>한 번의 누락</strong>이 리스크가 됩니다.
          </p>
        </div>

        <div class="panel-grid" data-stagger="70">
          <article class="panel" data-reveal="fade-up">
            <div class="panel-h">정보가 흩어짐</div>
            <p class="panel-p">대화/면담/문서/첨부가 분산되어 맥락이 끊깁니다.</p>
            <div class="panel-tag">CONTEXT LOSS</div>
          </article>

          <article class="panel" data-reveal="fade-up">
            <div class="panel-h">기록이 방어가 됨</div>
            <p class="panel-p">근거·시점·산출물이 없으면 사후 분쟁에 취약합니다.</p>
            <div class="panel-tag">EVIDENCE FIRST</div>
          </article>

          <article class="panel" data-reveal="fade-up">
            <div class="panel-h">절차 누락 리스크</div>
            <p class="panel-p">기한/순서/금지행위(PII 등)에서 실수가 납니다.</p>
            <div class="panel-tag">COMPLIANCE</div>
          </article>
        </div>
      </div>
    </section>

    <!-- PRODUCT -->
    <section id="product" class="scene scene-product" data-reveal="scene" aria-label="PRODUCT UI">
      <div class="container">
        <div class="product-head">
          <div class="pidx" data-reveal="fade">[1.0]</div>
          <h2 class="product-title" data-reveal="clip-up">Product interface</h2>
          <p class="product-lead" data-reveal="fade-up" data-delay="90">
            “화면”은 장식이 아니라, <strong>리스크를 줄이는 구조</strong>입니다.
            탐지 → 판단 → 실행 → 보관을 UI에서 끊김 없이 연결합니다.
          </p>
        </div>

        <div class="product-sticky">
          <div class="product-rail" aria-label="Product steps">
            <article class="pstep is-active" data-step="0">
              <header class="pstep-top">
                <h3 class="pstep-title" data-reveal="fade-up">Data Integration &amp; Ontology</h3>
                <div class="pstep-copy" data-reveal="fade-up" data-delay="90">
                  <p>
                    분산된 기록(상담·통지·보고·로그)을 <strong>공통 온톨로지</strong>로 묶어
                    케이스 단위로 검색·추적·감사 가능한 상태로 만듭니다.
                  </p>
                  <div class="pbullets">
                    <span class="pb">Ontology</span>
                    <span class="pb">Structured fields</span>
                    <span class="pb">Policy hooks</span>
                  </div>
                </div>
              </header>
              <div class="pstep-meta" data-reveal="fade-up" data-delay="110">
                <span class="pstep-k">MODE</span>
                <span class="pstep-v">Context unification · Case-first</span>
              </div>
            </article>

            <article class="pstep" data-step="1">
              <header class="pstep-top">
                <h3 class="pstep-title" data-reveal="fade-up">Decision Archiving &amp; Defensive Log</h3>
                <div class="pstep-copy" data-reveal="fade-up" data-delay="90">
                  <p>
                    의사결정과 조치의 흐름을 <strong>방어 로그(Defensive Log)</strong>로 고정합니다.
                    “언제/왜/무엇을/누가”를 증거로 남겨 <strong>사후 재현</strong>이 가능해집니다.
                  </p>
                  <div class="pbullets">
                    <span class="pb">Audit trail</span>
                    <span class="pb">Immutable history</span>
                    <span class="pb">Evidence pack</span>
                  </div>
                </div>
              </header>
              <div class="pstep-meta" data-reveal="fade-up" data-delay="110">
                <span class="pstep-k">OUTPUT</span>
                <span class="pstep-v">Defensive Log · Evidence Pack</span>
              </div>
            </article>

            <article class="pstep" data-step="2">
              <header class="pstep-top">
                <h3 class="pstep-title" data-reveal="fade-up">Strategy Simulation Engine</h3>
                <div class="pstep-copy" data-reveal="fade-up" data-delay="90">
                  <p>
                    선택지별 리스크/자원/결과를 비교해 <strong>최적 대응</strong>을 찾습니다.
                    감정이 아니라 <strong>프로토콜</strong>로 움직이게 하는 “리스크 전략무기”의 핵심입니다.
                  </p>
                  <div class="pbullets">
                    <span class="pb">Countermeasure</span>
                    <span class="pb">Risk score</span>
                    <span class="pb">Protocol response</span>
                  </div>
                </div>
              </header>
              <div class="pstep-meta" data-reveal="fade-up" data-delay="110">
                <span class="pstep-k">ENGINE</span>
                <span class="pstep-v">Compare outcomes · Safe defaults</span>
              </div>
            </article>
          </div>

          <aside class="product-view" aria-label="Sticky UI preview">
            <div class="ui-frame sticky-frame" data-reveal="zoom">
              <div class="pvisuals" aria-hidden="true">
                <img class="pvisual is-active" src="./assets/ui-02-ontology.png" alt="REDCLX Data Integration & Ontology UI" loading="lazy" decoding="async" width="1600" height="900"/>
                <img class="pvisual" src="./assets/ui-03-defensivelog.png" alt="REDCLX Decision Archiving & Defensive Log UI" loading="lazy" decoding="async" width="1600" height="900"/>
                <img class="pvisual" src="./assets/ui-04-simengine.png" alt="REDCLX Strategy Simulation Engine UI" loading="lazy" decoding="async" width="1600" height="900"/>
              </div>
            </div>

            <div class="ui-caption product-caption" aria-live="polite">
              <div class="pcap is-active" data-cap="0">
                <span class="cap-k">02 / ONTOLOGY</span>
                <span class="cap-v">Case mapping · Policy hooks · Unified context</span>
              </div>
              <div class="pcap" data-cap="1">
                <span class="cap-k">03 / DEFENSIVE LOG</span>
                <span class="cap-v">Audit trail · Immutable history · Evidence pack</span>
              </div>
              <div class="pcap" data-cap="2">
                <span class="cap-k">04 / SIMULATION</span>
                <span class="cap-v">Risk score · Countermeasure · Protocol response</span>
              </div>
            </div>
          </aside>
        </div>
      </div>
    </section>

    <!-- 3.0 / ENGINE -->
    <section id="c" class="scene scene-c" data-scene="c" data-reveal="scene" aria-label="ENGINE">
      <div class="container">
        <div class="engine">
          <div class="engine-left">
            <h2 class="scene-title" data-reveal="clip-up">ENGINE</h2>
            <p class="scene-lead" data-reveal="fade-up" data-delay="90">
              <strong>Neuro-Symbolic Compliance Engine</strong><br/>
              LLM(Neural)의 생성 + 규정 논리(Symbolic)의 검증을 결합해
              “검증 가능한 액션 그래프”를 만듭니다.
            </p>

            <div class="stack" data-stagger="70">
              <div class="stack-item" data-reveal="fade-up">
                <div class="stack-k">01 / POLICY COMPILATION</div>
                <div class="stack-v">MUST·MUST-NOT·기한·선후관계를 제약식으로 컴파일</div>
              </div>
              <div class="stack-item" data-reveal="fade-up">
                <div class="stack-k">02 / ACTION GRAPH</div>
                <div class="stack-v">자유 텍스트 대신 구조화 액션(JSON 스키마)만 생성</div>
              </div>
              <div class="stack-item" data-reveal="fade-up">
                <div class="stack-k">03 / VERIFIER + SELF-REPAIR</div>
                <div class="stack-v">누락/위반/순서오류를 잡고 Hold/추가질문으로 안전 전환</div>
              </div>
            </div>

            <div class="hero-actions" data-reveal="fade-up" data-delay="110">
              <a class="btn-solid" href="#d">파일럿 문의</a>
              <a class="btn-ghost" href="#a">Back to top</a>
            </div>
          </div>

          <div class="engine-right" data-stagger="70">
            <div class="engine-panel" data-reveal="fade-up">
              <div class="ep-k">OUTPUT CONTRACT</div>
              <div class="ep-v">Verified Actions only (Schema-bound)</div>
            </div>
            <div class="engine-panel" data-reveal="fade-up">
              <div class="ep-k">SAFE MODE</div>
              <div class="ep-v">Hold / Escalate / Ask-for-more</div>
            </div>
            <div class="engine-panel" data-reveal="fade-up">
              <div class="ep-k">DEFENSIBILITY</div>
              <div class="ep-v">Evidence Pack · Audit Trail · Compliance Gate</div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- 4.0 / GET STARTED -->
    <section id="d" class="scene scene-d" data-scene="d" data-reveal="scene" aria-label="Get Started">
      <div class="container">
        <div class="start">
          <h2 class="scene-title" data-reveal="clip-up">GET STARTED</h2>
          <p class="scene-lead" data-reveal="fade-up" data-delay="90">
            현장 검증(교사/학교)과 파일럿(B2B/B2G)을 함께 진행할 파트너를 찾습니다.
          </p>

          <div class="cta-grid">
            <form class="form" action="mailto:team@redclx.example" method="post" enctype="text/plain" aria-label="데모/베타 신청 폼" data-reveal="fade-up">
              <label>
                <span>이름 / 소속</span>
                <input name="name" autocomplete="name" placeholder="예) 홍길동 / OO초등학교" required />
              </label>
              <label>
                <span>이메일</span>
                <input type="email" name="email" autocomplete="email" placeholder="name@example.com" required />
              </label>
              <label>
                <span>관심 주제</span>
                <select name="interest">
                  <option>민원 대응</option>
                  <option>학폭/갈등 대응</option>
                  <option>기록/감사 대응</option>
                  <option>학교/교육청 운영</option>
                </select>
              </label>
              <label>
                <span>메시지</span>
                <textarea name="message" rows="4" placeholder="현재 겪는 문제/원하는 기능을 간단히 적어주세요."></textarea>
              </label>
              <button class="btn-solid" type="submit">신청 보내기</button>
              <p class="fine">* 현재는 메일 발송 방식입니다. 운영 시 서버 엔드포인트로 교체하세요.</p>
            </form>
          </div>

          <div class="footerline" data-reveal="fade-up" data-delay="110">
            <span class="dim">©</span> <span id="y">2025</span> <span class="dim">REDCLX. All rights reserved.</span>
            <span class="dot">·</span>
            <a class="dim" href="#a">Back to top</a>
          </div>
        </div>
      </div>
    </section>
  </main>

  <noscript>
    <div class="noscript">이 사이트는 자바스크립트 없이도 대부분의 콘텐츠를 볼 수 있습니다.</div>
  </noscript>

  <script>
    // Year
    document.getElementById("y").textContent = new Date().getFullYear();

    const reduceMotion = window.matchMedia("(prefers-reduced-motion: reduce)").matches;
    const isMobile =
      window.matchMedia("(pointer: coarse)").matches ||
      window.matchMedia("(max-width: 520px)").matches;

    const root = document.documentElement;
    if (isMobile) root.classList.add("is-mobile");

    // =========================
    // GLOBAL FX VARS — PC only (mobile lite: static)
    // =========================
    (() => {
      if (reduceMotion) return;

      if (isMobile) {
        root.style.setProperty("--mx", `${window.innerWidth * 0.55}px`);
        root.style.setProperty("--my", `${window.innerHeight * 0.22}px`);
        root.style.setProperty("--nx", "0");
        root.style.setProperty("--ny", "0");
        return;
      }

      let tx = window.innerWidth * 0.55;
      let ty = window.innerHeight * 0.22;
      let cx = tx, cy = ty;
      let raf = 0;

      const apply = () => {
        raf = 0;
        cx += (tx - cx) * 0.18;
        cy += (ty - cy) * 0.18;

        root.style.setProperty("--mx", `${cx.toFixed(1)}px`);
        root.style.setProperty("--my", `${cy.toFixed(1)}px`);

        const nx = (cx / Math.max(1, window.innerWidth)) - 0.5;
        const ny = (cy / Math.max(1, window.innerHeight)) - 0.5;
        root.style.setProperty("--nx", nx.toFixed(3));
        root.style.setProperty("--ny", ny.toFixed(3));
      };

      const request = () => {
        if (!raf) raf = requestAnimationFrame(apply);
      };

      window.addEventListener("pointermove", (e) => {
        tx = e.clientX; ty = e.clientY;
        request();
      }, { passive: true });

      window.addEventListener("touchstart", (e) => {
        if (!e.touches || !e.touches[0]) return;
        tx = e.touches[0].clientX;
        ty = e.touches[0].clientY;
        request();
      }, { passive: true });

      window.addEventListener("resize", () => {
        tx = window.innerWidth * 0.55;
        ty = window.innerHeight * 0.22;
        request();
      });

      request();
    })();

    // Chapter highlight
    const chapterLinks = Array.from(document.querySelectorAll(".chapter"));
    const scenes = Array.from(document.querySelectorAll("[data-scene]"));

    const setActive = (id) => {
      chapterLinks.forEach(a => a.classList.toggle("is-active", a.dataset.target === id));
      scenes.forEach(s => s.classList.toggle("is-current", s.dataset.scene === id));
    };

    const io = new IntersectionObserver((entries) => {
      const visible = entries
        .filter(e => e.isIntersecting)
        .sort((a,b) => (b.intersectionRatio - a.intersectionRatio))[0];
      if (visible) setActive(visible.target.dataset.scene);
    }, { threshold: [0.35, 0.55, 0.7] });

    scenes.forEach(s => io.observe(s));
    setActive("a");

    // Topbar settle
    (() => {
      const topbar = document.querySelector(".topbar");
      if (!topbar) return;
      const onScroll = () => topbar.classList.toggle("is-scrolled", window.scrollY > 60);
      onScroll();
      window.addEventListener("scroll", onScroll, { passive: true });
    })();

    // =========================
    // Reveal — repeatable (mobile 포함)
    // =========================
    (() => {
      if (reduceMotion) return;

      const els = Array.from(document.querySelectorAll("[data-reveal]"));

      const staggers = Array.from(document.querySelectorAll("[data-stagger]"));
      staggers.forEach(container => {
        const step = parseInt(container.dataset.stagger || "70", 10);
        const children = Array.from(container.children);
        children.forEach((ch, i) => {
          if (!ch.hasAttribute("data-reveal")) return;
          ch.style.transitionDelay = `${i * step}ms`;
        });
      });

      const rio = new IntersectionObserver((entries) => {
        entries.forEach(e => {
          const once = e.target.hasAttribute("data-once");
          if (e.isIntersecting) e.target.classList.add("is-inview");
          else if (!once) e.target.classList.remove("is-inview");
        });
      }, {
        threshold: [0, 0.12, 0.2],
        rootMargin: "0px 0px -12% 0px"
      });

      els.forEach(el => {
        const d = el.dataset.delay ? parseInt(el.dataset.delay, 10) : 0;
        if (d) el.style.transitionDelay = `${d}ms`;
        rio.observe(el);
      });
    })();

    // =========================
    // Parallax — ✅ 모바일 OFF (끊김 주범)
    // (hero-right 제거로 frames가 없으면 자동으로 아무 것도 안 함)
    // =========================
    (() => {
      if (reduceMotion || isMobile) return;

      const frames = Array.from(document.querySelectorAll(".ui-frame[data-parallax]"));
      if (!frames.length) return;

      let ticking = false;

      const update = () => {
        ticking = false;
        const vh = window.innerHeight || 800;

        frames.forEach(frame => {
          const speed = parseFloat(frame.dataset.parallax || "0.18");
          const range = parseFloat(frame.dataset.range || "70");
          const r = frame.getBoundingClientRect();

          if (r.bottom < -160 || r.top > vh + 160) return;

          const center = r.top + r.height / 2;
          const delta = (center - vh / 2) / (vh / 2);
          const y = (-delta) * range * speed;

          frame.style.setProperty("--py", `${y.toFixed(2)}px`);
        });
      };

      const onScroll = () => {
        if (!ticking) {
          ticking = true;
          requestAnimationFrame(update);
        }
      };

      update();
      window.addEventListener("scroll", onScroll, { passive: true });
      window.addEventListener("resize", onScroll);
    })();

    // PRODUCT Sticky Crossfade + burst
    (() => {
      const steps = Array.from(document.querySelectorAll(".pstep"));
      const visuals = Array.from(document.querySelectorAll(".pvisual"));
      const caps = Array.from(document.querySelectorAll(".pcap"));
      const frame = document.querySelector(".sticky-frame");
      if (!steps.length || !visuals.length) return;

      let last = 0;

      const burst = () => {
        if (!frame) return;
        frame.classList.remove("is-burst");
        void frame.offsetWidth;
        frame.classList.add("is-burst");
        clearTimeout(frame._bt);
        frame._bt = setTimeout(() => frame.classList.remove("is-burst"), 360);
      };

      const setActiveProduct = (i) => {
        if (i !== last) burst();
        last = i;

        steps.forEach((s, idx) => s.classList.toggle("is-active", idx === i));
        visuals.forEach((v, idx) => v.classList.toggle("is-active", idx === i));
        caps.forEach((c, idx) => c.classList.toggle("is-active", idx === i));
      };

      setActiveProduct(0);

      const pio = new IntersectionObserver((entries) => {
        const visible = entries
          .filter(e => e.isIntersecting)
          .sort((a, b) => b.intersectionRatio - a.intersectionRatio)[0];
        if (!visible) return;
        setActiveProduct(parseInt(visible.target.dataset.step || "0", 10));
      }, {
        threshold: [0.25, 0.4, 0.55, 0.7],
        rootMargin: "-15% 0px -35% 0px"
      });

      steps.forEach(s => pio.observe(s));
    })();
  </script>
</body>
</html>
