<!doctype html>
<html lang="ko" class="no-js">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />

  <title>REDCLX 레드클렉스</title>
  <meta name="description" content="REDCLX는 민원·학폭·갈등 대응을 ‘단계+규정+증거’로 표준화해 교사의 법적·행정적 리스크를 줄이는 Classroom OS입니다." />
  <meta name="robots" content="index,follow,max-image-preview:large,max-snippet:-1,max-video-preview:-1" />
  <meta name="theme-color" content="#0b0f14" />
  <link rel="canonical" href="https://www.redclexperice.com/" />
  <meta name="keywords" content="REDCLX, redclx, 레드클렉스, 레드클랙스, 교실 운영, 민원 대응, 학폭 대응, 증거 기록, Classroom OS" />

  <meta property="og:site_name" content="REDCLX (레드클렉스·레드클랙스)" />
  <meta property="og:type" content="website" />
  <meta property="og:locale" content="ko_KR" />
  <meta property="og:title" content="REDCLX | 교실 문제상황 대응 Classroom OS" />
  <meta property="og:description" content="민원·학폭·갈등 대응을 ‘검증 가능한 액션’과 ‘증거 패키지’로 표준화합니다." />
  <meta property="og:url" content="https://www.redclexperice.com/" />
  <meta property="og:image" content="https://www.redclexperice.com/assets/og.png" />

  <script>
    document.documentElement.classList.remove("no-js");
    document.documentElement.classList.add("js");
  </script>

  <link rel="preload" href="./styles.css" as="style" />
  <link rel="stylesheet" href="./styles.css" />
</head>

<body>
  <a class="skip-link" href="#main">본문 바로가기</a>

  <!-- GLOBAL MACRO FX (PC only / mobile lite disables via CSS) -->
  <div class="fx" aria-hidden="true"></div>

  <!-- Top Bar -->
  <header class="topbar" role="banner">
    <div class="topbar-inner">
      <a class="topbar-brand" href="#a" aria-label="REDCLX 홈">
        <span class="brand-mark" aria-hidden="true">
          <svg width="22" height="22" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M12 2l7 4v6c0 5-3 9-7 10-4-1-7-5-7-10V6l7-4z" stroke="currentColor" stroke-width="1.6"/>
            <path d="M7 12h10" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/>
          </svg>
        </span>
        <span class="brand-name">REDCLX</span>
      </a>

      <nav class="topbar-nav" aria-label="주요 메뉴">
        <a href="#team">TEAM</a>
        <a href="#b">WHY</a>
        <a href="#product">PRODUCT</a>
        <a href="#c">ENGINE</a>
        <a href="#d">GET STARTED</a>
      </nav>

      <div class="topbar-cta">
        <a class="btn-outline" href="#d">Get Started</a>

        <button class="icon-btn" type="button" aria-label="검색">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M10.5 18a7.5 7.5 0 1 1 0-15 7.5 7.5 0 0 1 0 15Z" stroke="currentColor" stroke-width="1.6"/>
            <path d="M16.6 16.6 21 21" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/>
          </svg>
        </button>

        <button class="icon-btn" type="button" aria-label="메뉴">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M4 7h16" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/>
            <path d="M4 12h16" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/>
            <path d="M4 17h16" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/>
          </svg>
        </button>
      </div>
    </div>
  </header>

  <!-- Left Chapters -->
  <nav class="chapters" aria-label="챕터">
    <a class="chapter" href="#a" data-target="a" aria-label="챕터 1.0"><span class="k">1.0</span></a>
    <a class="chapter" href="#b" data-target="b" aria-label="챕터 2.0"><span class="k">2.0</span></a>
    <a class="chapter" href="#c" data-target="c" aria-label="챕터 3.0"><span class="k">3.0</span></a>
    <a class="chapter" href="#d" data-target="d" aria-label="챕터 4.0"><span class="k">4.0</span></a>
  </nav>

  <main id="main">
    <!-- 1.0 / HERO -->
    <section id="a" class="scene scene-a" data-scene="a" data-reveal="scene" aria-label="REDCLX 메인">
      <div class="hero-bg" aria-hidden="true"></div>

      <div class="container">
        <div class="hero">
          <div class="hero-gotham" aria-hidden="true">REDCLX</div>

          <div class="hero-left">
            <div class="hudline" data-reveal="fade-up">
              <span class="hud-tag">EDUCATION RISK INTELLIGENCE</span>
              <span class="hud-sep">/</span>
              <span class="hud-quote">최고를 위한 교육리스크 전략무기</span>
            </div>

            <h1 class="hero-title" data-reveal="clip-up">
              REDCLX<br/>
              <span class="hero-strong"></span>
            </h1>

            <div class="hero-metrics" data-stagger="70">
              <div class="metric" data-reveal="fade-up">
                <div class="mk">OPERATING SYSTEM FOR</div>
                <div class="mv">Classroom Decision-Making</div>
              </div>
              <div class="metric" data-reveal="fade-up">
                <div class="mk">MODEL</div>
                <div class="mv">Evidence-first · Policy-aware</div>
              </div>
              <div class="metric" data-reveal="fade-up">
                <div class="mk">OUTPUT</div>
                <div class="mv">Best Action Plan · Evidence Pack</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- TEAM -->
    <section id="team" class="scene scene-team" data-reveal="scene" aria-label="TEAM">
      <div class="container">
        <div class="team-indexbar" aria-hidden="true" data-reveal="fade">
          <span class="tidx">[0.1]</span>
          <span class="tline"></span>
          <span class="tghost">0.2 — 0.3</span>
        </div>

        <div class="team-hero">
          <div class="team-left">
            <div class="team-path" data-reveal="fade-up">REDCLX / TEAM</div>

            <h2 class="team-display" data-reveal="clip-up">
              COGNITIVE<br>DENSITY
            </h2>

            <p class="team-sublead" data-reveal="fade-up" data-delay="90">
              글로벌 탑티어 학회(ICLR)에 닿아본 <strong>연구자의 집요함</strong>,</br>
              한계 상황을 돌파해 온 <strong>특수전적 기질</strong>,</br>
              우리는 문제를 단순히 푸는 것이 아니라, <strong>구조적으로 제압</strong>합니다.
            </p>
          </div>

          <div class="team-right">
            <p class="team-copy" data-reveal="fade-up"></p>

            <div class="team-spec" aria-label="Team capabilities" data-stagger="70">
              <div class="spec-row" data-reveal="fade-up">
                <div class="spec-k">STRUCTURAL INTEGRITY</div>
                <div class="spec-v">
                  복잡한 현상을 빈틈없이 해체하고 재조립하는 <strong>극한의 논리적 정합성</strong>.
                  규범과 원칙을 다루는 우리의 기준은 언제나 <strong>가장 높은 곳</strong>에 맞춰져 있습니다.
                </div>
              </div>

              <div class="spec-row" data-reveal="fade-up">
                <div class="spec-k">RESEARCH FRONTIER</div>
                <div class="spec-v">
                  ICLR 등 세계 최고 권위의 AI 학회 워크숍에서 검증된 경험.
                  단순 엔지니어링을 넘어, <strong>최신 연구의 흐름(SOTA)</strong>을
                  제품의 코어에 이식합니다.
                </div>
              </div>

              <div class="spec-row" data-reveal="fade-up">
                <div class="spec-k">MISSION ASSURANCE</div>
                <div class="spec-v">
                  특수전(Special Warfare) 요원의 DNA.
                  불가능해 보이는 미션 앞에서도 물러서지 않고,
                  끝내 <strong>결과를 만들어내는 실행력</strong>이 우리의 본질입니다.
                </div>
              </div>

              <div class="spec-row" data-reveal="fade-up">
                <div class="spec-k">HYPER-REALISM</div>
                <div class="spec-v">
                  이론에만 머무르지 않고, <strong>시장과 현장의 문제</strong>를
                  가장 날카로운 감각으로 포착하여
                  실질적인 솔루션으로 치환해냅니다.
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- 2.0 / WHY -->
    <section id="b" class="scene scene-b" data-scene="b" data-reveal="scene" aria-label="WHY">
      <div class="container">
        <div class="why-head">
          <h2 class="scene-title" data-reveal="clip-up">WHY</h2>
          <p class="scene-lead" data-reveal="fade-up" data-delay="90">
            문제는 ‘의지’가 아니라 ‘시스템’입니다. 사건은 복잡하고 기록은 흩어지며,
            <strong>한 번의 누락</strong>이 리스크가 됩니다.
          </p>
        </div>

        <div class="panel-grid" data-stagger="70">
          <article class="panel" data-reveal="fade-up">
            <div class="panel-h">정보가 흩어짐</div>
            <p class="panel-p">대화/면담/문서/첨부가 분산되어 맥락이 끊깁니다.</p>
            <div class="panel-tag">CONTEXT LOSS</div>
          </article>

          <article class="panel" data-reveal="fade-up">
            <div class="panel-h">기록이 방어가 됨</div>
            <p class="panel-p">근거·시점·산출물이 없으면 사후 분쟁에 취약합니다.</p>
            <div class="panel-tag">EVIDENCE FIRST</div>
          </article>

          <article class="panel" data-reveal="fade-up">
            <div class="panel-h">절차 누락 리스크</div>
            <p class="panel-p">기한/순서/금지행위(PII 등)에서 실수가 납니다.</p>
            <div class="panel-tag">COMPLIANCE</div>
          </article>
        </div>
      </div>
    </section>

    <!-- PRODUCT -->
    <section id="product" class="scene scene-product" data-reveal="scene" aria-label="PRODUCT UI">
      <div class="container">
        <div class="product-head">
          <div class="pidx" data-reveal="fade">[1.0]</div>
          <h2 class="product-title" data-reveal="clip-up">Product interface</h2>
          <p class="product-lead" data-reveal="fade-up" data-delay="90">
            “화면”은 장식이 아니라, <strong>리스크를 줄이는 구조</strong>입니다.
            탐지 → 판단 → 실행 → 보관을 UI에서 끊김 없이 연결합니다.
          </p>
        </div>

        <div class="product-sticky">
          <div class="product-rail" aria-label="Product steps">
            <article class="pstep is-active" data-step="0">
              <header class="pstep-top">
                <h3 class="pstep-title" data-reveal="fade-up">Data Integration &amp; Ontology</h3>
                <div class="pstep-copy" data-reveal="fade-up" data-delay="90">
                  <p>
                    분산된 기록(상담·통지·보고·로그)을 <strong>공통 온톨로지</strong>로 묶어
                    케이스 단위로 검색·추적·감사 가능한 상태로 만듭니다.
                  </p>
                  <div class="pbullets">
                    <span class="pb">Ontology</span>
                    <span class="pb">Structured fields</span>
                    <span class="pb">Policy hooks</span>
                  </div>
                </div>
              </header>
              <div class="pstep-meta" data-reveal="fade-up" data-delay="110">
                <span class="pstep-k">MODE</span>
                <span class="pstep-v">Context unification · Case-first</span>
              </div>
            </article>

            <article class="pstep" data-step="1">
              <header class="pstep-top">
                <h3 class="pstep-title" data-reveal="fade-up">Decision Archiving &amp; Defensive Log</h3>
                <div class="pstep-copy" data-reveal="fade-up" data-delay="90">
                  <p>
                    의사결정과 조치의 흐름을 <strong>방어 로그(Defensive Log)</strong>로 고정합니다.
                    “언제/왜/무엇을/누가”를 증거로 남겨 <strong>사후 재현</strong>이 가능해집니다.
                  </p>
                  <div class="pbullets">
                    <span class="pb">Audit trail</span>
                    <span class="pb">Immutable history</span>
                    <span class="pb">Evidence pack</span>
                  </div>
                </div>
              </header>
              <div class="pstep-meta" data-reveal="fade-up" data-delay="110">
                <span class="pstep-k">OUTPUT</span>
                <span class="pstep-v">Defensive Log · Evidence Pack</span>
              </div>
            </article>

            <article class="pstep" data-step="2">
              <header class="pstep-top">
                <h3 class="pstep-title" data-reveal="fade-up">Strategy Simulation Engine</h3>
                <div class="pstep-copy" data-reveal="fade-up" data-delay="90">
                  <p>
                    선택지별 리스크/자원/결과를 비교해 <strong>최적 대응</strong>을 찾습니다.
                    감정이 아니라 <strong>프로토콜</strong>로 움직이게 하는 “리스크 전략무기”의 핵심입니다.
                  </p>
                  <div class="pbullets">
                    <span class="pb">Countermeasure</span>
                    <span class="pb">Risk score</span>
                    <span class="pb">Protocol response</span>
                  </div>
                </div>
              </header>
              <div class="pstep-meta" data-reveal="fade-up" data-delay="110">
                <span class="pstep-k">ENGINE</span>
                <span class="pstep-v">Compare outcomes · Safe defaults</span>
              </div>
            </article>
          </div>

          <aside class="product-view" aria-label="Sticky UI preview">
            <div class="ui-frame sticky-frame" data-reveal="zoom">
              <div class="pvisuals" aria-hidden="true">
                <img class="pvisual is-active" src="./assets/ui-02-ontology.png" alt="REDCLX Data Integration & Ontology UI" loading="lazy" decoding="async" width="1600" height="900"/>
                <img class="pvisual" src="./assets/ui-03-defensivelog.png" alt="REDCLX Decision Archiving & Defensive Log UI" loading="lazy" decoding="async" width="1600" height="900"/>
                <img class="pvisual" src="./assets/ui-04-simengine.png" alt="REDCLX Strategy Simulation Engine UI" loading="lazy" decoding="async" width="1600" height="900"/>
              </div>
            </div>

            <div class="ui-caption product-caption" aria-live="polite">
              <div class="pcap is-active" data-cap="0">
                <span class="cap-k">02 / ONTOLOGY</span>
                <span class="cap-v">Case mapping · Policy hooks · Unified context</span>
              </div>
              <div class="pcap" data-cap="1">
                <span class="cap-k">03 / DEFENSIVE LOG</span>
                <span class="cap-v">Audit trail · Immutable history · Evidence pack</span>
              </div>
              <div class="pcap" data-cap="2">
                <span class="cap-k">04 / SIMULATION</span>
                <span class="cap-v">Risk score · Countermeasure · Protocol response</span>
              </div>
            </div>
          </aside>
        </div>
      </div>
    </section>

    <!-- 3.0 / ENGINE (일반인 친화 + 최고성능 전략 강조 버전) -->
    <section id="c" class="scene scene-c" data-scene="c" data-reveal="scene" aria-label="ENGINE">
      <div class="container">
        <div class="engine engine-v2">
          <div class="engine-left">
            <div class="engine-eyebrow" data-reveal="fade-up">
              NEURO-SYMBOLIC ENGINE
              <span class="engine-dot">•</span>
              Verified Action Graph Generation
            </div>

            <h2 class="scene-title" data-reveal="clip-up">ENGINE</h2>

            <p class="scene-lead engine-lead" data-reveal="fade-up" data-delay="90">
              REDCLX는 LLM의 추론 능력(Neural)과 규정의 엄격한 논리(Symbolic)를 결합하여,<br/>
              단순 텍스트가 아닌 <strong>검증된 액션 그래프(Verified Action Graph)</strong>를 생성합니다.
              <span class="lead-sub">수천 번의 시뮬레이션과 <strong>자기 수정(Self-Repair)</strong>을 거쳐, 규정 위반 확률을 0에 수렴시킨 <strong>단 하나의 최적 전략(Best Action)</strong>만을 도출합니다.</span>
            </p>

            <div class="engine-pills" data-stagger="70" aria-label="Engine highlights">
              <div class="pill" data-reveal="fade-up">
                <div class="pill-k">Constraint Satisfaction</div>
                <div class="pill-v">Must/Must-Not 제약조건의 완전한 충족</div>
              </div>
              <div class="pill" data-reveal="fade-up">
                <div class="pill-k">Formal Verification</div>
                <div class="pill-v">정형 검증기가 반례를 찾아 스스로 수정</div>
              </div>
              <div class="pill" data-reveal="fade-up">
                <div class="pill-k">Audit-Ready Artifacts</div>
                <div class="pill-v">감사 가능한 근거 인용 및 증거 패키징</div>
              </div>
            </div>

            <div class="engine-steps" aria-label="3-step pipeline" data-stagger="70">
              <div class="estep" data-reveal="fade-up">
                <div class="estep-k">01 / POLICY COMPILATION</div>
                <div class="estep-v">
                  자연어 정책 문서를 기계 판독 가능한 <strong>논리 제약식(Logic Constraints)</strong>과
                  <strong>액션 온톨로지</strong>로 컴파일하여 판단 기준을 확립합니다.
                </div>
              </div>

              <div class="estep" data-reveal="fade-up">
                <div class="estep-k">02 / GRAPH GENERATION</div>
                <div class="estep-v">
                  사건을 노드(Action)와 엣지(Dependency)로 구조화된 <strong>Action Graph</strong>로 변환하며,
                  가능한 모든 대응 시나리오의 <strong>최적 경로</strong>를 탐색합니다.
                </div>
              </div>

              <div class="estep" data-reveal="fade-up">
                <div class="estep-k">03 / VERIFIER &amp; SELF-REPAIR</div>
                <div class="estep-v">
                  생성된 전략을 <strong>정형 검증기(Formal Verifier)</strong>가 타격하여 반례를 찾고,
                  엔진이 이를 <strong>스스로 수정(Self-Repair)</strong>한 뒤 최종 출력합니다.
                </div>
              </div>
            </div>

            <div class="engine-output" data-reveal="fade-up" data-delay="110" aria-label="Output preview">
              <div class="out-head">
                <div class="out-k">OUTPUT</div>
                <div class="out-v">Optimized Action Graph · Evidence Pack</div>
              </div>

              <div class="out-grid">
                <div class="out-card">
                  <div class="out-title">Verified Action Graph</div>
                  <ul class="out-list">
                    <li>노드: 실행해야 할 구체적 액션(Node)</li>
                    <li>엣지: 선후관계 및 필수 의존성(Edge)</li>
                    <li>메타: 기한·근거·리스크가 태깅된 스키마</li>
                  </ul>
                </div>

                <div class="out-card">
                  <div class="out-title">Evidence Pack</div>
                  <ul class="out-list">
                    <li>방어적 로그(Log) 템플릿 생성</li>
                    <li>필수 증거물/산출물 구조화</li>
                    <li>감사 대응용 근거 조항(Span) 매핑</li>
                  </ul>
                </div>
              </div>

              <details class="engine-advanced">
                <summary>Advanced (Technical Methodology)</summary>
                <div class="adv-body">
                  <p class="adv-p">
                    본 엔진은 <strong>Neuro-Symbolic Compliance Engine</strong> 프레임워크를 기반으로
                    환각(Hallucination)을 구조적으로 차단합니다.
                  </p>
                  <ul class="adv-ul">
                    <li><strong>Policy Compilation:</strong> 법령/지침을 If-Then-Must 제약식으로 변환</li>
                    <li><strong>Formal Verifier:</strong> 위반/누락 발생 시 반례(Counterexample) 리포트 생성</li>
                    <li><strong>Self-Repair Loop:</strong> 반례를 기반으로 LLM이 전략을 반복 수정 및 최적화</li>
                    <li><strong>Safety Policy:</strong> 정보 부족 시 '추천' 대신 질문/보류(Abstention)로 안전 전환</li>
                  </ul>
                </div>
              </details>
            </div>

            <div class="hero-actions" data-reveal="fade-up" data-delay="130">
              <a class="btn-solid" href="#d">파일럿 문의</a>
              <a class="btn-ghost" href="#a">Research Paper</a>
            </div>
          </div>

        </div>
      </div>
    </section>

    <!-- 4.0 / GET STARTED -->
    <section id="d" class="scene scene-d" data-scene="d" data-reveal="scene" aria-label="Get Started">
      <div class="container">
        <div class="start">
          <h2 class="scene-title" data-reveal="clip-up">GET STARTED</h2>
          <p class="scene-lead" data-reveal="fade-up" data-delay="90">
            현장 검증(교사/학교)과 파일럿(B2B/B2G)을 함께 진행할 파트너를 찾습니다.
          </p>

          <div class="cta-grid">
            <form class="form" action="mailto:team@redclx.example" method="post" enctype="text/plain" aria-label="데모/베타 신청 폼" data-reveal="fade-up">
              <label>
                <span>이름 / 소속</span>
                <input name="name" autocomplete="name" placeholder="예) 홍길동 / OO초등학교" required />
              </label>
              <label>
                <span>이메일</span>
                <input type="email" name="email" autocomplete="email" placeholder="name@example.com" required />
              </label>
              <label>
                <span>관심 주제</span>
                <select name="interest">
                  <option>민원 대응</option>
                  <option>학폭/갈등 대응</option>
                  <option>기록/감사 대응</option>
                  <option>학교/교육청 운영</option>
                </select>
              </label>
              <label>
                <span>메시지</span>
                <textarea name="message" rows="4" placeholder="현재 겪는 문제/원하는 기능을 간단히 적어주세요."></textarea>
              </label>
              <button class="btn-solid" type="submit">신청 보내기</button>
              <p class="fine">* 현재는 메일 발송 방식입니다. 운영 시 서버 엔드포인트로 교체하세요.</p>
            </form>
          </div>

          <div class="footerline" data-reveal="fade-up" data-delay="110">
            <span class="dim">©</span> <span id="y">2025</span> <span class="dim">REDCLX. All rights reserved.</span>
            <span class="dot">·</span>
            <a class="dim" href="#a">Back to top</a>
          </div>
        </div>
      </div>
    </section>
  </main>

  <noscript>
    <div class="noscript">이 사이트는 자바스크립트 없이도 대부분의 콘텐츠를 볼 수 있습니다.</div>
  </noscript>

  <script>
    // Year
    document.getElementById("y").textContent = new Date().getFullYear();

    const reduceMotion = window.matchMedia("(prefers-reduced-motion: reduce)").matches;
    const isMobile =
      window.matchMedia("(pointer: coarse)").matches ||
      window.matchMedia("(max-width: 520px)").matches;

    const root = document.documentElement;
    if (isMobile) root.classList.add("is-mobile");

    // =========================
    // GLOBAL FX VARS — PC only (mobile lite: static)
    // =========================
    (() => {
      if (reduceMotion) return;

      if (isMobile) {
        root.style.setProperty("--mx", `${window.innerWidth * 0.55}px`);
        root.style.setProperty("--my", `${window.innerHeight * 0.22}px`);
        root.style.setProperty("--nx", "0");
        root.style.setProperty("--ny", "0");
        return;
      }

      let tx = window.innerWidth * 0.55;
      let ty = window.innerHeight * 0.22;
      let cx = tx, cy = ty;
      let raf = 0;

      const apply = () => {
        raf = 0;
        cx += (tx - cx) * 0.18;
        cy += (ty - cy) * 0.18;

        root.style.setProperty("--mx", `${cx.toFixed(1)}px`);
        root.style.setProperty("--my", `${cy.toFixed(1)}px`);

        const nx = (cx / Math.max(1, window.innerWidth)) - 0.5;
        const ny = (cy / Math.max(1, window.innerHeight)) - 0.5;
        root.style.setProperty("--nx", nx.toFixed(3));
        root.style.setProperty("--ny", ny.toFixed(3));
      };

      const request = () => {
        if (!raf) raf = requestAnimationFrame(apply);
      };

      window.addEventListener("pointermove", (e) => {
        tx = e.clientX; ty = e.clientY;
        request();
      }, { passive: true });

      window.addEventListener("touchstart", (e) => {
        if (!e.touches || !e.touches[0]) return;
        tx = e.touches[0].clientX;
        ty = e.touches[0].clientY;
        request();
      }, { passive: true });

      window.addEventListener("resize", () => {
        tx = window.innerWidth * 0.55;
        ty = window.innerHeight * 0.22;
        request();
      });

      request();
    })();

    // Chapter highlight
    const chapterLinks = Array.from(document.querySelectorAll(".chapter"));
    const scenes = Array.from(document.querySelectorAll("[data-scene]"));

    const setActive = (id) => {
      chapterLinks.forEach(a => a.classList.toggle("is-active", a.dataset.target === id));
      scenes.forEach(s => s.classList.toggle("is-current", s.dataset.scene === id));
    };

    const io = new IntersectionObserver((entries) => {
      const visible = entries
        .filter(e => e.isIntersecting)
        .sort((a,b) => (b.intersectionRatio - a.intersectionRatio))[0];
      if (visible) setActive(visible.target.dataset.scene);
    }, { threshold: [0.35, 0.55, 0.7] });

    scenes.forEach(s => io.observe(s));
    setActive("a");

    // Topbar settle
    (() => {
      const topbar = document.querySelector(".topbar");
      if (!topbar) return;
      const onScroll = () => topbar.classList.toggle("is-scrolled", window.scrollY > 60);
      onScroll();
      window.addEventListener("scroll", onScroll, { passive: true });
    })();

    // =========================
    // Reveal — repeatable (mobile 포함)
    // =========================
    (() => {
      if (reduceMotion) return;

      const els = Array.from(document.querySelectorAll("[data-reveal]"));

      const staggers = Array.from(document.querySelectorAll("[data-stagger]"));
      staggers.forEach(container => {
        const step = parseInt(container.dataset.stagger || "70", 10);
        const children = Array.from(container.children);
        children.forEach((ch, i) => {
          if (!ch.hasAttribute("data-reveal")) return;
          ch.style.transitionDelay = `${i * step}ms`;
        });
      });

      const rio = new IntersectionObserver((entries) => {
        entries.forEach(e => {
          const once = e.target.hasAttribute("data-once");
          if (e.isIntersecting) e.target.classList.add("is-inview");
          else if (!once) e.target.classList.remove("is-inview");
        });
      }, {
        threshold: [0, 0.12, 0.2],
        rootMargin: "0px 0px -12% 0px"
      });

      els.forEach(el => {
        const d = el.dataset.delay ? parseInt(el.dataset.delay, 10) : 0;
        if (d) el.style.transitionDelay = `${d}ms`;
        rio.observe(el);
      });
    })();

    // Parallax — 모바일 OFF
    (() => {
      if (reduceMotion || isMobile) return;

      const frames = Array.from(document.querySelectorAll(".ui-frame[data-parallax]"));
      if (!frames.length) return;

      let ticking = false;

      const update = () => {
        ticking = false;
        const vh = window.innerHeight || 800;

        frames.forEach(frame => {
          const speed = parseFloat(frame.dataset.parallax || "0.18");
          const range = parseFloat(frame.dataset.range || "70");
          const r = frame.getBoundingClientRect();

          if (r.bottom < -160 || r.top > vh + 160) return;

          const center = r.top + r.height / 2;
          const delta = (center - vh / 2) / (vh / 2);
          const y = (-delta) * range * speed;

          frame.style.setProperty("--py", `${y.toFixed(2)}px`);
        });
      };

      const onScroll = () => {
        if (!ticking) {
          ticking = true;
          requestAnimationFrame(update);
        }
      };

      update();
      window.addEventListener("scroll", onScroll, { passive: true });
      window.addEventListener("resize", onScroll);
    })();

    // PRODUCT Sticky Crossfade + burst
    (() => {
      const steps = Array.from(document.querySelectorAll(".pstep"));
      const visuals = Array.from(document.querySelectorAll(".pvisual"));
      const caps = Array.from(document.querySelectorAll(".pcap"));
      const frame = document.querySelector(".sticky-frame");
      if (!steps.length || !visuals.length) return;

      let last = 0;

      const burst = () => {
        if (!frame) return;
        frame.classList.remove("is-burst");
        void frame.offsetWidth;
        frame.classList.add("is-burst");
        clearTimeout(frame._bt);
        frame._bt = setTimeout(() => frame.classList.remove("is-burst"), 360);
      };

      const setActiveProduct = (i) => {
        if (i !== last) burst();
        last = i;

        steps.forEach((s, idx) => s.classList.toggle("is-active", idx === i));
        visuals.forEach((v, idx) => v.classList.toggle("is-active", idx === i));
        caps.forEach((c, idx) => c.classList.toggle("is-active", idx === i));
      };

      setActiveProduct(0);

      const pio = new IntersectionObserver((entries) => {
        const visible = entries
          .filter(e => e.isIntersecting)
          .sort((a, b) => b.intersectionRatio - a.intersectionRatio)[0];
        if (!visible) return;
        setActiveProduct(parseInt(visible.target.dataset.step || "0", 10));
      }, {
        threshold: [0.25, 0.4, 0.55, 0.7],
        rootMargin: "-15% 0px -35% 0px"
      });

      steps.forEach(s => pio.observe(s));
    })();
  </script>
</body>
</html>
